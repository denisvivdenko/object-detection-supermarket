schema: '2.0'
stages:
  data_preprocessing:
    cmd: python src/stages/data_preprocessing.py --config=params.yaml
    deps:
    - path: data/SKU110K_fixed
      hash: md5
      md5: cf62ba74c1ee35825611f7eb715bb94a.dir
      size: 13014663172
      nfiles: 11748
    params:
      params.yaml:
        base:
          random_state: 42
        yolo_preprocessing:
          n_augmentations: 2
          data_path: data/dataset
          images_dir: data/SKU110K_fixed/images
          unprocessed_dataset_path: data/SKU110K_fixed
          max_batch_size: 50
    outs:
    - path: data/dataset
      hash: md5
      md5: 43159d469c82104ce8a5ea1033afc8cf.dir
      size: 171502723
      nfiles: 918
  train:
    cmd: python src/stages/train.py --config=params.yaml
    deps:
    - path: data/dataset
      hash: md5
      md5: e113ee1f0393b3eb42eb4502c641c4a4.dir
      size: 172472888
      nfiles: 920
    - path: models/yolov8n.pt
      hash: md5
      md5: 0305608151dd1725c9d7da6882ae52d5
      size: 6534387
    params:
      params.yaml:
        base:
          random_state: 42
        training:
          name: experiment-1
          base_model_path: models/yolov8n.pt
          save_fpath: models/yolo_trained_model.pt
          yolo_params: yolo_params.yaml
          epochs: 1
          batch_size: 4
        yolo_preprocessing:
          n_augmentations: 2
          data_path: data/dataset
          images_dir: data/SKU110K_fixed/images
          unprocessed_dataset_path: data/SKU110K_fixed
          max_batch_size: 50
    outs:
    - path: models/yolo_trained_model.pt
      hash: md5
      md5: 9775808a430e23dd4ab1550e773a4c84
      size: 6217518
    - path: runs
      hash: md5
      md5: 2d1a49142c3dda6dabd65797c38fc059.dir
      size: 19487713
      nfiles: 22
  evaluate:
    cmd: python src/stages/evaluate.py --config=params.yaml
    deps:
    - path: models/yolo_trained_model.pt
      hash: md5
      md5: 9775808a430e23dd4ab1550e773a4c84
      size: 6217518
    params:
      params.yaml:
        base:
          random_state: 42
        evaluation:
          models_dir: runs/detect
        training:
          name: experiment-1
          base_model_path: models/yolov8n.pt
          save_fpath: models/yolo_trained_model.pt
          yolo_params: yolo_params.yaml
          epochs: 1
          batch_size: 4
        yolo_preprocessing:
          n_augmentations: 2
          data_path: data/dataset
          images_dir: data/SKU110K_fixed/images
          unprocessed_dataset_path: data/SKU110K_fixed
          max_batch_size: 50
    outs:
    - path: metrics/plots
      hash: md5
      md5: aa65ee608e92869953cf0454f74a2f81.dir
      size: 1868356
      nfiles: 1
